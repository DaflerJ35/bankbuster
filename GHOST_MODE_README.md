# Ghost Mode - Secure Backend Documentation

## Overview

The BankPenetrator tool now includes a secure "Ghost Mode" backend designed for stealth operations and maximum security. This mode implements multiple layers of security, anonymity, and encryption to ensure the tool remains "ghost on the web".

## Security Features

### üîê Authentication & Access Control
- **Multi-Factor Authentication (2FA)** using TOTP (Time-based One-Time Passwords)
- **Rate limiting** to prevent brute force attacks
- **Account lockout** after failed login attempts
- **Device fingerprinting** for additional security
- **Session integrity** validation
- **Secure password hashing** using Werkzeug

### üëª Ghost Mode Features
- **Stealth headers** to avoid detection
- **Anti-fingerprinting** measures
- **Tor proxy support** for anonymized traffic
- **Encrypted storage** for all sensitive data
- **Memory-only operations** where possible
- **Secure session management**
- **Audit logging** for security monitoring

### üõ°Ô∏è Encryption & Privacy
- **AES-256 encryption** for data at rest
- **Fernet encryption** for secure tokens
- **Encrypted database fields** for sensitive information
- **Secure random token generation**
- **Anti-timing attack** protections

## Quick Start

### 1. Install Dependencies
```bash
pip install -r requirements.txt
```

### 2. Start Ghost Mode
```bash
# Method 1: Direct ghost startup (Recommended)
python ghost_startup.py

# Method 2: Main script with ghost flag
python main.py --ghost

# Method 3: Environment variable
set GHOST_MODE=true
python main.py
```

### 3. First Time Setup

When you first run Ghost Mode, it will:
1. Generate secure encryption keys
2. Initialize the database
3. Create an admin user with a random password
4. **IMPORTANT**: Save the admin password shown in the console!

### 4. Access the Application
- Open your browser to: `http://localhost:5000`
- Login with username: `admin`
- Use the password provided during first setup
- Set up 2FA for enhanced security

## Configuration

### Environment Variables

```bash
# Ghost Mode Configuration
GHOST_MODE=true                    # Enable ghost mode
ENCRYPTION_PASSWORD=<auto-generated> # Encryption key
SESSION_SECRET=<auto-generated>     # Session secret
TOR_ENABLED=true                   # Enable Tor proxy (if available)
```

### Tor Setup (Optional)

For maximum anonymity, install and configure Tor:

1. **Windows**: Download Tor Browser or Tor Expert Bundle
2. **Start Tor**: Ensure Tor is running on port 9050
3. **Verification**: Ghost Mode will automatically detect and use Tor

## Security Best Practices

### üîí Access Control
- Always use the admin account for initial setup
- Enable 2FA immediately after first login
- Change the default admin password
- Create separate user accounts for team members
- Regularly review audit logs

### üåê Network Security
- Run only on localhost (127.0.0.1) - never expose to public internet
- Use Tor proxy for external communications
- Monitor network connections
- Use VPN in addition to Tor for extra protection

### üíæ Data Protection
- All sensitive data is encrypted at rest
- Session data is encrypted and validated
- Temporary files are securely deleted
- Database backups should be encrypted

## Two-Factor Authentication (2FA)

### Setup Process
1. Login with username/password
2. Navigate to "Setup 2FA" in the dashboard
3. Scan QR code with authenticator app (Google Authenticator, Authy, etc.)
4. Enter 6-digit verification code
5. 2FA is now active for your account

### Supported Authenticator Apps
- Google Authenticator
- Authy
- Microsoft Authenticator
- Any TOTP-compatible app

## Troubleshooting

### Common Issues

**Issue**: "Admin password not shown"
- **Solution**: Check the console output during first startup
- **Alternative**: Delete the database file and restart

**Issue**: "2FA code not working"
- **Solution**: Ensure device time is synchronized
- **Check**: Verify QR code was scanned correctly

**Issue**: "Tor not detected"
- **Solution**: Install and start Tor service
- **Check**: Verify port 9050 is listening

**Issue**: "Encryption errors"
- **Solution**: Delete ghost.log and restart
- **Check**: Ensure sufficient disk space

### Log Files
- **ghost.log**: Ghost mode operations and errors
- **audit.log**: Security events and login attempts
- **app.log**: General application logs

## Security Monitoring

### Audit Events
The system logs all security-relevant events:
- Login attempts (successful/failed)
- 2FA setup/disable
- Account lockouts
- Session activities
- Administrative actions

### Monitoring Commands
```bash
# View recent security events
tail -f ghost.log

# Check failed login attempts
grep "FAILED_LOGIN" ghost.log

# Monitor active sessions
grep "SESSION" ghost.log
```

## Advanced Configuration

### Custom Encryption
To use custom encryption keys:
```bash
set ENCRYPTION_PASSWORD=your_secure_key_here
python ghost_startup.py
```

### Database Encryption
All sensitive database fields are automatically encrypted:
- User passwords (hashed + salted)
- TOTP secrets
- Session tokens
- Scan results
- Target information

### Session Security
- Sessions expire after inactivity
- Session tokens are rotated regularly
- Device fingerprinting prevents session hijacking
- Secure cookie settings prevent XSS/CSRF

## Emergency Procedures

### Account Lockout Recovery
1. Wait for lockout period to expire (default: 15 minutes)
2. Or manually reset in database:
   ```python
   from app import app, db
   from models import User
   with app.app_context():
       user = User.query.filter_by(username='admin').first()
       user.reset_failed_attempts()
       db.session.commit()
   ```

### Reset 2FA
```python
from app import app, db
from models import User
with app.app_context():
    user = User.query.filter_by(username='admin').first()
    user.totp_secret = None
    db.session.commit()
```

### Complete Reset
1. Stop the application
2. Delete database file: `rm instance/database.db`
3. Delete logs: `rm *.log`
4. Restart: `python ghost_startup.py`

## Support

For security issues or questions:
1. Check the troubleshooting section
2. Review log files for error details
3. Ensure all dependencies are installed
4. Verify system requirements are met

---

**‚ö†Ô∏è SECURITY WARNING**: This tool is designed for authorized penetration testing and security research only. Always ensure you have proper authorization before using this tool against any systems.

**üîí PRIVACY NOTICE**: Ghost Mode implements strong privacy protections, but users are responsible for following local laws and regulations regarding privacy and security testing.